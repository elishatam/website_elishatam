<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="ArmC_files/filelist.xml">
<title>/***************************************************************************</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="State"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="City"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:PunctuationKerning/>
  <w:DrawingGridHorizontalSpacing>6 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>6 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>3</w:DisplayVerticalDrawingGridEvery>
  <w:UseMarginsForDrawingGridOrigin/>
  <w:ValidateAgainstSchemas>false</w:ValidateAgainstSchemas>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotUnderlineInvalidXML/>
  <w:DoNotShadeFormData/>
  <w:Compatibility>
   <w:SpaceForUL/>
   <w:BalanceSingleByteDoubleByteWidth/>
   <w:DoNotLeaveBackslashAlone/>
   <w:ULTrailSpace/>
   <w:DoNotExpandShiftReturn/>
   <w:FootnoteLayoutLikeWW8/>
   <w:ShapeLayoutLikeWW8/>
   <w:AlignTablesRowByRow/>
   <w:ForgetLastTabAlignment/>
   <w:AdjustLineHeightInTable/>
   <w:LayoutRawTableWidth/>
   <w:LayoutTableRowsApart/>
   <w:UseWord97LineBreakingRules/>
   <w:SelectEntireFieldWithStartOrEnd/>
   <w:UseWord2002TableStyleRules/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
 /* Page Definitions */
 @page
	{mso-page-border-surround-header:no;
	mso-page-border-surround-footer:no;}
@page Section1
	{size:841.85pt 1190.55pt;
	margin:56.7pt 56.7pt 56.7pt 56.7pt;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in;text-justify-trim:punctuation'>

<div class=Section1>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>/***************************************************************************</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=SpellE><i><span style='font-size:10.0pt;
font-family:"Courier New";color:#666666'>Arm.c</span></i></span><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>ME 218B Project Hats Off</span></i><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>Team Firefox</span></i><span style='font-size:10.0pt;font-family:
"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>March 7, 2010</span></i><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>Upper arm stepper = PS2, PS3, PP0, PP2</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>Lower arm servo = Timer0 PT2, Timer 6</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>DDRT = 0x4;<span style='mso-spacerun:yes'>                  
</span>//<span class=GramE>00000100<span style='mso-spacerun:yes'>  </span>for</span>
servo</span></i><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>DDRP = 0x05;<span style='mso-spacerun:yes'>                 
</span>//<span class=GramE>00000101<span style='mso-spacerun:yes'>  </span>for</span>
stepper 1=output</span></i><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>DDRS = 0x0C;<span style='mso-spacerun:yes'>                 
</span>//<span class=GramE>00001100<span style='mso-spacerun:yes'>  </span>for</span>
stepper 1=output</span></i><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>***************************************************************************/</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>/*-------------------------- Include Files
-------------------------------*/</span></i><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:#00B800'>#include</span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span style='color:red'>&quot;<span class=SpellE>Arm.h</span>&quot;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>/*-------------------------- Module Definitions
-----------------------------*/</span></i><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:#00B800'>#define CMD <span class=SpellE>fullCmds</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=SpellE><span class=GramE><span
style='font-size:10.0pt;font-family:"Courier New";color:#EC7F15'>typedef</span></span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span class=SpellE><span
style='color:blue'>enum</span></span> <span style='color:red'>{</span><span
style='mso-spacerun:yes'>   </span><span style='color:black'>HIGH_ARM</span><span
style='color:red'>,</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-tab-count:2'>            </span><span
style='mso-spacerun:yes'>     </span>LOW_ARM</span><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>             </span><span style='color:red'>}</span> <span
class=SpellE><span style='color:black'>ARM_t</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>/*-------------------------- Module Functions
-----------------------------*/</span></i><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> void</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>pulseServo</span></b></span><span style='color:red'>(</span><span
style='color:blue'>unsigned <span class=SpellE>int</span></span> <span
style='color:black'>width</span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> void</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>stepMotor</span></b></span><span style='color:red'>(</span><span
class=SpellE><span style='color:blue'>int</span></span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> void</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>StepMotorModule_runMotor</span></b></span><span
style='color:red'>(</span><span class=SpellE><span style='color:blue'>int</span></span><span
style='color:red'>,</span> <span class=SpellE><span style='color:blue'>int</span></span><span
style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>/*-------------------------- Module Variables
-----------------------------*/</span></i><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_desPos</span></span><span
style='color:red'>;</span><span style='mso-spacerun:yes'>      </span><i><span
style='color:#666666'>//lower arm servo</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_curPos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_desPos</span></span><span
style='color:red'>;</span><span style='mso-spacerun:yes'>    </span><i><span
style='color:#666666'>//upper arm stepper</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_curPos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_lastCmdTime</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>lastStepTime</span></span><span
style='color:red'>,</span> <span class=SpellE><span style='color:black'>curTime</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>curStepStage</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>skipSize</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>/*-------------------------- <st1:place w:st="on"><st1:City
 w:st="on">Module</st1:City> <st1:State w:st="on">Cal</st1:State></st1:place>
Variables -------------------------*/</span></i><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span class=SpellE><span
style='color:black'>ARM_t</span></span><span style='color:black'> <span
class=SpellE>TargetHeights</span></span><span style='color:red'>[</span><span
style='color:#A900A9'>16</span><span style='color:red'>] = {</span><span
style='mso-spacerun:yes'>    </span><span style='color:black'>HIGH_ARM</span><span
style='color:red'>,</span> <i><span style='color:#666666'>//0</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>HIGH_ARM</span><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>,</span><span style='font-size:10.0pt;font-family:"Courier New"'> <i><span
style='color:#666666'>//1</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>LOW_ARM</span><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:red'>,</span><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>  </span><i><span
style='color:#666666'>/</span></i></span></span><i><span style='font-size:10.0pt;
font-family:"Courier New";color:#666666'>/2</span></i><span style='font-size:
10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>HIGH_ARM</span><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>,</span><span style='font-size:10.0pt;font-family:"Courier New"'> <i><span
style='color:#666666'>//3</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>HIGH_ARM</span><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>,</span><span style='font-size:10.0pt;font-family:"Courier New"'> <i><span
style='color:#666666'>//4</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>LOW_ARM</span><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:red'>,</span><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>  </span><i><span
style='color:#666666'>/</span></i></span></span><i><span style='font-size:10.0pt;
font-family:"Courier New";color:#666666'>/5</span></i><span style='font-size:
10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>HIGH_ARM</span><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>,</span><span style='font-size:10.0pt;font-family:"Courier New"'> <i><span
style='color:#666666'>//6</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>HIGH_ARM</span><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>,</span><span style='font-size:10.0pt;font-family:"Courier New"'> <i><span
style='color:#666666'>//7</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>                        </span><span
style='mso-spacerun:yes'>                    </span>HIGH_ARM</span><span
style='font-size:10.0pt;font-family:"Courier New";color:red'>,</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <i><span style='color:#666666'>//8</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>HIGH_ARM</span><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>,</span><span style='font-size:10.0pt;font-family:"Courier New"'> <i><span
style='color:#666666'>//9</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>LOW_ARM</span><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:red'>,</span><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>  </span><i><span
style='color:#666666'>/</span></i></span></span><i><span style='font-size:10.0pt;
font-family:"Courier New";color:#666666'>/10</span></i><span style='font-size:
10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>HIGH_ARM</span><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>,</span><span style='font-size:10.0pt;font-family:"Courier New"'> <i><span
style='color:#666666'>//11</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                            </span>HIGH_ARM</span><span
style='font-size:10.0pt;font-family:"Courier New";color:red'>,</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <i><span style='color:#666666'>//12</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>LOW_ARM</span><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:red'>,</span><span style='font-size:10.0pt;
font-family:"Courier New"'><span style='mso-spacerun:yes'>  </span><i><span
style='color:#666666'>/</span></i></span></span><i><span style='font-size:10.0pt;
font-family:"Courier New";color:#666666'>/13</span></i><span style='font-size:
10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>HIGH_ARM</span><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>,</span><span style='font-size:10.0pt;font-family:"Courier New"'> <i><span
style='color:#666666'>//14</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span
style='mso-spacerun:yes'>                                           
</span>HIGH_ARM</span><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}<span class=GramE>;<i><span style='color:#666666'>/</span></i></span></span><i><span
style='font-size:10.0pt;font-family:"Courier New";color:#666666'>/15</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//servo <span class=SpellE>minPulseWidth</span> = 1550
--&gt;<span style='mso-spacerun:yes'>   </span>0degrees</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//servo <span class=SpellE>maxPulseWidth</span> = 8000
--&gt;<span style='mso-spacerun:yes'>   </span>180degrees</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>cmdDelayMS</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>22</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_outPos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>1520</span><span
style='color:red'>;</span> <span style='mso-spacerun:yes'> </span><i><span
style='color:#666666'>//7600;<span style='mso-spacerun:yes'>  </span>flip to
swing the other way. <span class=GramE>also</span> switch inequality sign in</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'><span
style='mso-spacerun:yes'>                                         </span><span
style='mso-spacerun:yes'>      </span><span style='mso-spacerun:yes'> </span>//<span
class=SpellE>isArmStopped</span></span></i><span style='font-size:10.0pt;
font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_homePos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>7600</span><span
style='color:red'>;</span> <i><span style='color:#666666'>//1520;</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_midPos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>4000</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_waveOutPos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>3000</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_waveInPos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>4000</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_highPos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>450</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_lowPos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>500</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_homePos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>0</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_topPos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>350</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_midPos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>100</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_attackPos</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>220</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_slowSkip</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>120</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_fastSkip</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>200</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static unsigned <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>servo_waveSkip</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>80</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_waitTimeFast</span></span>
<span style='color:red'>=</span> <span style='color:#A900A9'>4</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>stepper_waitTimeSlow</span></span>
<span style='color:red'>=</span> <span style='color:#A900A9'>7</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span style='color:black'>CW</span> <span style='color:red'>=</span> <span
style='color:#A900A9'>1</span><span style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span style='color:black'>CCW</span> <span style='color:red'>=</span> <span
style='color:#A900A9'>0</span><span style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>maxSteps</span></span> <span
style='color:red'>=</span> <span style='color:#A900A9'>4</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>fullCmds</span></span><span
style='color:red'>[] = {</span><span style='color:#A900A9'>10</span><span
style='color:red'>,</span> <span style='color:#A900A9'>9</span><span
style='color:red'>,</span> <span style='color:#A900A9'>5</span><span
style='color:red'>,</span> <span style='color:#A900A9'>6</span><span
style='color:red'>};</span> <i><span style='color:#666666'>//full step drive</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>waveCmds</span></span><span
style='color:red'>[] = {</span><span style='color:#A900A9'>8</span><span
style='color:red'>,</span> <span style='color:#A900A9'>1</span><span
style='color:red'>,</span> <span style='color:#A900A9'>4</span><span
style='color:red'>,</span> <span style='color:#A900A9'>2</span><span
style='color:red'>};</span><span style='mso-spacerun:yes'>  </span><i><span
style='color:#666666'>//Wave drive</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>const</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> static <span
class=SpellE>int</span></span><span style='font-size:10.0pt;font-family:"Courier New"'>
<span class=SpellE><span style='color:black'>halfCmds</span></span><span
style='color:red'>[] = {</span><span style='color:#A900A9'>10</span><span
style='color:red'>,</span> <span style='color:#A900A9'>8</span><span
style='color:red'>,</span> <span style='color:#A900A9'>9</span><span
style='color:red'>,</span> <span style='color:#A900A9'>1</span><span
style='color:red'>,</span> <span style='color:#A900A9'>5</span><span
style='color:red'>,</span> <span style='color:#A900A9'>4</span><span
style='color:red'>,</span> <span style='color:#A900A9'>6</span><span
style='color:red'>,</span> <span style='color:#A900A9'>2</span><span
style='color:red'>};</span> <i><span style='color:#666666'>//Half step drive</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Initializes OC on the servo to create a higher resolution PWM</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>void</span></span><span style='font-size:
10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>Arm_Init</span></b></span><span style='color:red'>(</span><span
style='color:blue'>void</span><span style='color:red'>) {</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><b><span
style='color:black'>MyTimer_<span class=GramE>Init</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span style='color:red'>);</span><span
style='mso-tab-count:4'>                       </span> <i><span
style='color:#666666'>//Already initializes Timer 0 to 3MHz</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><i><span style='color:#666666'>//TIM0_TSCR1
|= _S12_TEN;<span style='mso-tab-count:1'> </span><span
style='mso-spacerun:yes'>            </span>//Enable timer</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><i><span style='color:#666666'>//TIM0_TSCR2
= _S12_PR1 | _S12_PR0;<span style='mso-spacerun:yes'>  </span><span
style='mso-spacerun:yes'> </span>//24MHz/8 = 3MHz</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span>TIM0_TIOS</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>|=</span>
<span style='color:black'>_S12_IOS6</span><span style='color:red'>;</span><span
style='mso-spacerun:yes'>  </span><span style='mso-tab-count:3'>             </span><i><span
style='color:#666666'>//Set timer0 channel 6 to OC</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span>TIM0_TCTL1</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>|=</span>
<span style='color:black'>_S12_OL6</span> <span style='color:red'>|</span> <span
style='color:black'>_S12_OM6</span><span style='color:red'>;</span> <span
style='mso-tab-count:1'>   </span><i><span style='color:#666666'>//Program a
rise on compare</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span>TIM0_TTOV</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>|=</span>
<span style='color:black'>_S12_TOV6</span><span style='color:red'>;</span><span
style='mso-spacerun:yes'>  </span><span style='mso-tab-count:3'>             </span><i><span
style='color:#666666'>//Toggle bit6 on overflow</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span class=SpellE><span class=GramE><b><span
style='color:black'>pulseServo</span></b></span></span><span class=GramE><span
style='color:red'>(</span></span><span class=SpellE><span style='color:black'>servo_homePos</span></span><span
style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE>servo_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>servo_homePos</span></span><span
style='color:red'>;</span><span style='mso-tab-count:2'>         </span><i><span
style='color:#666666'>//Set servo to home position</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE>stepper_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>stepper_homePos</span></span><span
style='color:red'>;</span><span style='mso-tab-count:1'>     </span><i><span
style='color:#666666'>//Set stepper to home position</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE><span
class=GramE>lastStepTime</span></span></span><span style='font-size:10.0pt;
font-family:"Courier New"'> <span style='color:red'>=</span> <span
class=SpellE><b><span style='color:black'>MyTimer_GetTime</span></b></span><span
style='color:red'>();</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE>servo_lastCmdTime</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><b><span style='color:black'>MyTimer_<span class=GramE>GetTime</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE><span
class=GramE>curStepStage</span></span></span><span style='font-size:10.0pt;
font-family:"Courier New"'> <span style='color:red'>=</span> <span
style='color:#A900A9'>0</span><span style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-tab-count:1'>      </span>PTS</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>&amp;=
(</span><span style='color:black'>BIT2LO</span><span style='color:red'>);</span><span
style='mso-spacerun:yes'>      </span><i><span style='color:#666666'>//Turn off
both coils in stepper motor</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-tab-count:1'>      </span>PTS</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>&amp;=
(</span><span style='color:black'>BIT3LO</span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-tab-count:1'>      </span>PTP</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>&amp;=
(</span><span style='color:black'>BIT2LO</span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-tab-count:1'>      </span>PTP</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>&amp;=
(</span><span style='color:black'>BIT0LO</span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Steps the motor based on <span class=SpellE>waitTime</span></span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> void</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>StepMotorModule_runMotor</span></b></span><span
style='color:red'>(</span><span class=SpellE><span style='color:blue'>int</span></span>
<span class=SpellE><span style='color:black'>waitTime</span></span><span
style='color:red'>,</span> <span class=SpellE><span style='color:blue'>int</span></span>
<span style='color:black'>dir</span><span style='color:red'>) {</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE><span
class=GramE>curTime</span></span></span><span style='font-size:10.0pt;
font-family:"Courier New"'> <span style='color:red'>=</span> <span
class=SpellE><b><span style='color:black'>MyTimer_GetTime</span></b></span><span
style='color:red'>();</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>((</span><span
class=SpellE><span style='color:black'>curTime</span></span> <span
style='color:red'>-</span> <span class=SpellE><span style='color:black'>lastStepTime</span></span><span
style='color:red'>) &gt;=</span> <span class=SpellE><span style='color:black'>waitTime</span></span><span
style='color:red'>) {</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:2'>            </span><span class=SpellE><span
class=GramE><b><span style='color:black'>stepMotor</span></b></span></span><span
class=GramE><span style='color:red'>(</span></span><span style='color:black'>dir</span><span
style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-tab-count:2'>            </span><span
class=SpellE><span class=GramE>lastStepTime</span></span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>curTime</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Steps the stepper motor using full step drive</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> void</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>stepMotor</span></b></span><span style='color:red'>(</span><span
class=SpellE><span style='color:blue'>int</span></span> <span style='color:
black'>dir</span><span style='color:red'>) {</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><span style='color:blue'>char</span></span>
<span style='color:black'>temp</span><span style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>if</span></b></span>
<span style='color:red'>(</span><span style='color:black'>dir</span> <span
style='color:red'>==</span> <span style='color:#A900A9'>0</span><span
style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE><span
class=GramE>curStepStage</span></span></span><span style='font-size:10.0pt;
font-family:"Courier New"'> <span style='color:red'>=</span> <span
class=SpellE><span style='color:black'>curStepStage</span></span> <span
style='color:red'>+</span> <span style='color:#A900A9'>1</span><span
style='color:red'>;</span><span style='mso-tab-count:1'>      </span><i><span
style='color:#666666'>//Update current step in array</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span style='mso-tab-count:
1'>    </span><span class=SpellE><span class=GramE>stepper_curPos</span></span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:red'>++;</span><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>else</span></b><span style='color:red'>{</span></span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-tab-count:1'>      </span><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>curStepStage</span></span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>curStepStage</span></span> <span
style='color:red'>-</span> <span style='color:#A900A9'>1</span><span
style='color:red'>;</span><span style='mso-tab-count:1'>  </span><i><span
style='color:#666666'>//Update current step in array</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-tab-count:1'>      </span><span
style='mso-spacerun:yes'>  </span><span class=SpellE><span class=GramE>stepper_curPos</span></span></span><span
class=GramE><span style='font-size:10.0pt;font-family:"Courier New";color:red'>--</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:red'>;</span><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>curStepStage</span></span> <span
style='color:red'>&lt;</span> <span style='color:#A900A9'>0</span><span
style='color:red'>)</span> <span class=SpellE><span style='color:black'>curStepStage</span></span>
<span style='color:red'>=</span> <span style='color:black'>maxSteps</span><span
style='color:red'>-</span><span style='color:#A900A9'>1</span><span
style='color:red'>;</span><span style='mso-tab-count:1'>      </span><i><span
style='color:#666666'>//If overflow the array, loop back</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>curStepStage</span></span> <span
style='color:red'>==</span> <span class=SpellE><span style='color:black'>maxSteps</span></span><span
style='color:red'>)</span> <span class=SpellE><span style='color:black'>curStepStage</span></span>
<span style='color:red'>=</span> <span style='color:#A900A9'>0</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=GramE>temp</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>= (</span><span
style='color:blue'>char</span><span style='color:red'>)(</span><span
style='color:black'>CMD</span><span style='color:red'>[</span><span
class=SpellE><span style='color:black'>curStepStage</span></span><span
style='color:red'>]);</span><span style='mso-tab-count:3'>             </span><span
style='mso-spacerun:yes'>           </span><i><span style='color:#666666'>//CMD
= <span class=SpellE>fullCmds</span> array</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><i><span style='color:#666666'>//write out to
0 pin PS2</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
style='color:black'>temp</span> <span style='color:red'>&amp;</span> <span
style='color:black'>BIT0HI</span><span style='color:red'>)</span> <span
style='color:black'>PTS</span> <span style='color:red'>|=</span> <span
style='color:black'>BIT2HI</span><span style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>else</span></b></span> <span style='color:black'>PTS</span> <span
style='color:red'>&amp;=</span> <span style='color:black'>BIT2LO</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><i><span style='color:#666666'>//write out to
1 pin PS3</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
style='color:black'>temp</span> <span style='color:red'>&amp;</span> <span
style='color:black'>BIT1HI</span><span style='color:red'>)</span> <span
style='color:black'>PTS</span> <span style='color:red'>|=</span> <span
style='color:black'>BIT3HI</span><span style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>else</span></b></span> <span style='color:black'>PTS</span> <span
style='color:red'>&amp;=</span> <span style='color:black'>BIT3LO</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><i><span style='color:#666666'>//write out
to 2 pin PP2</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
style='color:black'>temp</span> <span style='color:red'>&amp;</span> <span
style='color:black'>BIT2HI</span><span style='color:red'>)</span> <span
style='color:black'>PTP</span> <span style='color:red'>|=</span> <span
style='color:black'>BIT2HI</span><span style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>else</span></b></span> <span style='color:black'>PTP</span> <span
style='color:red'>&amp;=</span> <span style='color:black'>BIT2LO</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><i><span style='color:#666666'>//write out
to 3 pin PP0</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
style='color:black'>temp</span> <span style='color:red'>&amp;</span> <span
style='color:black'>BIT3HI</span><span style='color:red'>)</span> <span
style='color:black'>PTP</span> <span style='color:red'>|=</span> <span
style='color:black'>BIT0HI</span><span style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-tab-count:1'>      </span><span class=GramE><b><span
style='color:blue'>else</span></b></span> <span style='color:black'>PTP</span> <span
style='color:red'>&amp;=</span> <span style='color:black'>BIT0LO</span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Set the pulse width of the rise time on OC.</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//A change in width causes a change in servo angle</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>static</span></span><span
style='font-size:10.0pt;font-family:"Courier New";color:blue'> void</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>pulseServo</span></b></span><span style='color:red'>(</span><span
style='color:blue'>unsigned <span class=SpellE>int</span></span> <span
style='color:black'>width</span><span style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span>TIM0_TC6</span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span style='color:#A900A9'>0xffff</span><span style='color:red'>-</span><span
style='color:black'>width</span><span style='color:red'>;</span><span
style='mso-tab-count:1'>    </span><span style='mso-spacerun:yes'>         
</span><i><span style='color:#666666'>//Sets the pulse width</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE>servo_curPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span style='color:black'>width</span><span style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Set servo and stepper to home position</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>void</span></span><span style='font-size:
10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>goToHomePosition</span></b></span><span style='color:red'>(</span><span
style='color:blue'>void</span><span style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE>stepper_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>stepper_homePos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE>servo_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>servo_homePos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Set servo and stepper to attack position</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>void</span></span><span style='font-size:
10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>goToAttackPosition</span></b></span><span style='color:
red'>(</span><span style='color:blue'>void</span><span style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE>stepper_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>stepper_attackPos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE>servo_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>servo_homePos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Begin the wave sequence in the servo and stepper</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>void</span></span><span style='font-size:
10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>waveArm</span></b></span><span style='color:red'>(</span><span
style='color:blue'>void</span><span style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE>stepper_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>stepper_attackPos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE>servo_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>servo_outPos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE><span
class=GramE>skipSize</span></span></span><span style='font-size:10.0pt;
font-family:"Courier New"'> <span style='color:red'>=</span> <span
class=SpellE><span style='color:black'>servo_waveSkip</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Checks if the arm has stopped waving.</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Returns 1 if desired position == current position for both
stepper and servo</span></i><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>char</span></span><span style='font-size:
10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>isWaveStopped</span></b></span><span style='color:red'>(</span><span
style='color:blue'>void</span><span style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>if</span></b></span>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>stepper_desPos</span></span>
<span style='color:red'>!=</span> <span class=SpellE><span style='color:black'>stepper_curPos</span></span><span
style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>stepper_desPos</span></span> <span
style='color:red'>&gt;</span> <span class=SpellE><span style='color:black'>stepper_curPos</span></span><span
style='color:red'>){</span><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:2'>          </span><span
style='mso-spacerun:yes'>      </span><i><span style='color:#666666'>//Send arm
out</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=SpellE><b><span
style='color:black'>StepMotorModule_<span class=GramE>runMotor</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span class=SpellE><span
style='color:black'>stepper_waitTimeFast</span></span><span style='color:red'>,</span>
<span style='color:black'>CCW</span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span class=GramE><b><span
style='color:blue'>else</span></b></span><b><span style='color:blue'> if</span></b>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>stepper_desPos</span></span>
<span style='color:red'>&lt;</span> <span class=SpellE><span style='color:black'>stepper_curPos</span></span><span
style='color:red'>){</span><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:2'>            </span><i><span style='color:#666666'>//Bring
arm in</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>stepper_curPos</span></span> <span
style='color:red'>&gt;</span> <span class=SpellE><span style='color:black'>stepper_topPos</span></span><span
style='color:red'>){</span> <span style='mso-tab-count:2'>          </span><span
style='mso-spacerun:yes'>      </span><i><span style='color:#666666'>//When
raising arm after swinging, step slower.</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=SpellE><b><span
style='color:black'>StepMotorModule_<span class=GramE>runMotor</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span class=SpellE><span
style='color:black'>stepper_waitTimeSlow</span></span><span style='color:red'>,</span>
<span style='color:black'>CW</span><span style='color:red'>);</span><span
style='mso-tab-count:1'> </span><i><span style='color:#666666'>//(otherwise it
skips b/c it can't raise the arm that fast)</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=GramE><b><span
style='color:blue'>else</span></b></span><span style='mso-spacerun:yes'> 
</span><span style='mso-tab-count:8'>                                                </span><i><span
style='color:#666666'>//Step faster after passing the high point.</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=SpellE><b><span
style='color:black'>StepMotorModule_<span class=GramE>runMotor</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span class=SpellE><span
style='color:black'>stepper_waitTimeFast</span></span><span style='color:red'>,</span>
<span style='color:black'>CW</span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>if</span></b></span>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>servo_desPos</span></span>
<span style='color:red'>!=</span> <span class=SpellE><span style='color:black'>servo_curPos</span></span><span
style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>((</span><span
class=SpellE><b><span style='color:black'>MyTimer_GetTime</span></b></span><span
style='color:red'>() -</span> <span class=SpellE><span style='color:black'>servo_lastCmdTime</span></span><span
style='color:red'>) &gt;</span> <span class=SpellE><span style='color:black'>cmdDelayMS</span></span><span
style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>      </span><span class=SpellE>servo_lastCmdTime</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><b><span style='color:black'>MyTimer_<span class=GramE>GetTime</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><b><span style='color:blue'>if</span></b>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>servo_desPos</span></span>
<span style='color:red'>&lt;</span> <span class=SpellE><span style='color:black'>servo_curPos</span></span><span
style='color:red'>){</span> <span style='mso-tab-count:5'>                          </span><span
style='mso-spacerun:yes'>      </span><i><span style='color:#666666'>//Wave out</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>servo_curPos</span></span> <span
style='color:red'>&lt;=</span> <span class=SpellE><span style='color:black'>servo_waveInPos</span></span><span
style='color:red'>)</span> <span class=SpellE><span style='color:black'>skipSize</span></span>
<span style='color:red'>=</span> <span class=SpellE><span style='color:black'>servo_waveSkip</span></span><span
style='color:red'>;</span> <i><span style='color:#666666'>//Wave beginning
point. Once past, move at</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'><span style='mso-spacerun:yes'>            </span><span
class=SpellE><span class=GramE>waveSkip</span></span></span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=GramE><b><span
style='color:blue'>else</span></b></span> <span class=SpellE><span
style='color:black'>skipSize</span></span> <span style='color:red'>=</span> <span
class=SpellE><span style='color:black'>servo_slowSkip</span></span><span
style='color:red'>;</span> <span style='mso-tab-count:5'>                          </span><i><span
style='color:#666666'>//When not in wave region, move slow</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=SpellE><span class=GramE><b><span
style='color:black'>pulseServo</span></b></span></span><span class=GramE><span
style='color:red'>(</span></span><span class=SpellE><span style='color:black'>servo_curPos</span></span>
<span style='color:red'>-</span> <span class=SpellE><span style='color:black'>skipSize</span></span><span
style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=GramE><b><span
style='color:blue'>else</span></b></span><b><span style='color:blue'> if</span></b>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>servo_desPos</span></span>
<span style='color:red'>&gt;</span> <span class=SpellE><span style='color:black'>servo_curPos</span></span><span
style='color:red'>){</span> <span style='mso-tab-count:4'>                     </span><i><span
style='color:#666666'>//Wave in</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>        </span><span class=SpellE><span
class=GramE>skipSize</span></span></span><span style='font-size:10.0pt;
font-family:"Courier New"'> <span style='color:red'>=</span> <span
class=SpellE><span style='color:black'>servo_waveSkip</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=SpellE><span class=GramE><b><span
style='color:black'>pulseServo</span></b></span></span><span class=GramE><span
style='color:red'>(</span></span><span class=SpellE><span style='color:black'>servo_curPos</span></span>
<span style='color:red'>+</span> <span class=SpellE><span style='color:black'>skipSize</span></span><span
style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>if</span></b></span>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>servo_curPos</span></span>
<span style='color:red'>&lt;=</span> <span class=SpellE><span style='color:
black'>servo_waveOutPos</span></span><span style='color:red'>){</span><span
style='mso-spacerun:yes'>    </span><i><span style='color:#666666'>//When servo
gets to the end of the wave, bring servo back to wave beginning</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE>servo_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>servo_waveInPos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>return</span></b></span>
<span style='color:red'>((</span><span class=SpellE><span style='color:black'>servo_curPos</span></span>
<span style='color:red'>==</span> <span class=SpellE><span style='color:black'>servo_desPos</span></span><span
style='color:red'>) &amp;&amp; (</span><span class=SpellE><span
style='color:black'>stepper_curPos</span></span> <span style='color:red'>==</span>
<span class=SpellE><span style='color:black'>stepper_desPos</span></span><span
style='color:red'>));</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Swing the arm to the target height (either high or low)</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>void</span></span><span style='font-size:
10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>swingArm</span></b></span><span style='color:red'>(</span><span
class=SpellE><span style='color:blue'>int</span></span> <span class=SpellE><span
style='color:black'>targetNum</span></span><span style='color:red'>) {</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=SpellE>ARM_t</span>
pos</span><span style='font-size:10.0pt;font-family:"Courier New";color:red'>;</span><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>  </span><span class=GramE>pos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>TargetHeights</span></span><span
style='color:red'>[</span><span class=SpellE><span style='color:black'>targetNum</span></span><span
style='color:red'>];</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>if</span></b></span>
<span style='color:red'>(</span><span style='color:black'>pos</span> <span
style='color:red'>==</span> <span style='color:black'>HIGH_ARM</span><span
style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE>stepper_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>stepper_highPos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE><span
class=GramE>skipSize</span></span></span><span style='font-size:10.0pt;
font-family:"Courier New"'> <span style='color:red'>=</span> <span
class=SpellE><span style='color:black'>servo_slowSkip</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>else</span></b><span
style='color:red'>{</span></span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE>stepper_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>stepper_lowPos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE><span
class=GramE>skipSize</span></span></span><span style='font-size:10.0pt;
font-family:"Courier New"'> <span style='color:red'>=</span> <span
class=SpellE><span style='color:black'>servo_slowSkip</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><i><span style='font-size:10.0pt;font-family:"Courier New";
color:#666666'>//Checks to see if the arm has stopped moving</span></i><span
style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span class=GramE><span style='font-size:10.0pt;
font-family:"Courier New";color:blue'>char</span></span><span style='font-size:
10.0pt;font-family:"Courier New"'> <span class=SpellE><b><span
style='color:black'>isArmStopped</span></b></span><span style='color:red'>(</span><span
style='color:blue'>void</span><span style='color:red'>) {</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>if</span></b></span>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>stepper_desPos</span></span>
<span style='color:red'>!=</span> <span class=SpellE><span style='color:black'>stepper_curPos</span></span><span
style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>stepper_desPos</span></span> <span
style='color:red'>&gt;</span> <span class=SpellE><span style='color:black'>stepper_curPos</span></span><span
style='color:red'>){</span> <span style='mso-tab-count:7'>                                          </span><i><span
style='color:#666666'>//Need to raise arm</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=SpellE><b><span
style='color:black'>StepMotorModule_<span class=GramE>runMotor</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span class=SpellE><span
style='color:black'>stepper_waitTimeFast</span></span><span style='color:red'>,</span>
<span style='color:black'>CCW</span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>stepper_curPos</span></span> <span
style='color:red'>&gt;=</span> <span style='color:black'>stepper_attackPos</span><span
style='color:red'>+</span><span style='color:#A900A9'>1</span><span
style='color:red'>)</span> <span class=SpellE><span style='color:black'>servo_desPos</span></span>
<span style='color:red'>=</span> <span class=SpellE><span style='color:black'>servo_midPos</span></span><span
style='color:red'>;</span> <span style='mso-tab-count:1'>      </span><i><span
style='color:#666666'>//Swing out the servo partway</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>stepper_curPos</span></span> <span
style='color:red'>&gt;=</span> <span class=SpellE><span style='color:black'>stepper_highPos</span></span><span
style='color:red'>)</span> <span class=SpellE><span style='color:black'>servo_desPos</span></span>
<span style='color:red'>=</span> <span class=SpellE><span style='color:black'>servo_outPos</span></span><span
style='color:red'>;</span> <span style='mso-tab-count:2'>          </span><i><span
style='color:#666666'>//Swing servo for attack</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span class=GramE><b><span
style='color:blue'>else</span></b></span><b><span style='color:blue'> if</span></b>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>stepper_desPos</span></span>
<span style='color:red'>&lt;</span> <span class=SpellE><span style='color:black'>stepper_curPos</span></span><span
style='color:red'>){</span> <span style='mso-tab-count:7'>                                     </span><i><span
style='color:#666666'>//Need to bring back in</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>stepper_curPos</span></span> <span
style='color:red'>&gt;</span> <span class=SpellE><span style='color:black'>stepper_topPos</span></span><span
style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=SpellE><b><span
style='color:black'>StepMotorModule_<span class=GramE>runMotor</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span class=SpellE><span
style='color:black'>stepper_waitTimeSlow</span></span><span style='color:red'>,</span>
<span style='color:black'>CW</span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=GramE><b><span
style='color:blue'>else</span></b></span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=SpellE><b><span
style='color:black'>StepMotorModule_<span class=GramE>runMotor</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span class=SpellE><span
style='color:black'>stepper_waitTimeFast</span></span><span style='color:red'>,</span>
<span style='color:black'>CW</span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>if</span></b></span>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>servo_desPos</span></span>
<span style='color:red'>!=</span> <span class=SpellE><span style='color:black'>servo_curPos</span></span><span
style='color:red'>){</span><span style='mso-spacerun:yes'>    </span><span
style='mso-tab-count:6'>                                </span><span
style='mso-spacerun:yes'>      </span><i><span style='color:#666666'>//Need to
swing lower servo</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>((</span><span
class=SpellE><b><span style='color:black'>MyTimer_GetTime</span></b></span><span
style='color:red'>() -</span> <span class=SpellE><span style='color:black'>servo_lastCmdTime</span></span><span
style='color:red'>) &gt;</span> <span class=SpellE><span style='color:black'>cmdDelayMS</span></span><span
style='color:red'>){</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>      </span><span class=SpellE>servo_lastCmdTime</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><b><span style='color:black'>MyTimer_<span class=GramE>GetTime</span></span></b></span><span
class=GramE><span style='color:red'>(</span></span><span style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>servo_desPos</span></span> <span
style='color:red'>&gt;</span> <span class=SpellE><span style='color:black'>servo_curPos</span></span><span
style='color:red'>){</span><span style='mso-spacerun:yes'>   </span><span
style='mso-tab-count:6'>                                    </span><i><span
style='color:#666666'>//Bring servo back</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=SpellE><span class=GramE><b><span
style='color:black'>pulseServo</span></b></span></span><span class=GramE><span
style='color:red'>(</span></span><span class=SpellE><span style='color:black'>servo_curPos</span></span>
<span style='color:red'>+</span> <span class=SpellE><span style='color:black'>skipSize</span></span><span
style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=GramE><b><span
style='color:blue'>if</span></b></span> <span style='color:red'>(</span><span
class=SpellE><span style='color:black'>servo_curPos</span></span> <span
style='color:red'>&gt;=</span> <span class=SpellE><span style='color:black'>servo_midPos</span></span><span
style='color:red'>)</span> <span class=SpellE><span style='color:black'>stepper_desPos</span></span>
<span style='color:red'>=</span> <span class=SpellE><span style='color:black'>stepper_attackPos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span class=GramE><b><span
style='color:blue'>else</span></b></span><b><span style='color:blue'> if</span></b>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>servo_desPos</span></span>
<span style='color:red'>&lt;</span> <span class=SpellE><span style='color:black'>servo_curPos</span></span><span
style='color:red'>){</span><span style='mso-spacerun:yes'>  </span><span
style='mso-tab-count:4'>                    </span><span
style='mso-spacerun:yes'>  </span><span style='mso-tab-count:1'>    </span><span
style='mso-spacerun:yes'>     </span><i><span style='color:#666666'>//Swing
servo out</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>        </span><span class=SpellE><span class=GramE><b><span
style='color:black'>pulseServo</span></b></span></span><span class=GramE><span
style='color:red'>(</span></span><span class=SpellE><span style='color:black'>servo_curPos</span></span>
<span style='color:red'>-</span> <span class=SpellE><span style='color:black'>skipSize</span></span><span
style='color:red'>);</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>      </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>    </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>if</span></b></span>
<span style='color:red'>(</span><span class=SpellE><span style='color:black'>servo_curPos</span></span>
<span style='color:red'>&lt;=</span> <span class=SpellE><span style='color:
black'>servo_outPos</span></span><span style='color:red'>){</span><span
style='mso-spacerun:yes'>  </span><i><span style='color:#666666'>//<span
class=SpellE>homePos</span> = 7600, <span class=SpellE>outPos</span> = 1520</span></i><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:black'><span style='mso-spacerun:yes'>    </span><span class=SpellE>servo_desPos</span></span><span
style='font-size:10.0pt;font-family:"Courier New"'> <span style='color:red'>=</span>
<span class=SpellE><span style='color:black'>servo_homePos</span></span><span
style='color:red'>;</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span style='color:red'>}</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style='mso-spacerun:yes'>  </span><span class=GramE><b><span style='color:blue'>return</span></b></span>
<span style='color:red'>((</span><span class=SpellE><span style='color:black'>servo_curPos</span></span>
<span style='color:red'>==</span> <span class=SpellE><span style='color:black'>servo_desPos</span></span><span
style='color:red'>) &amp;&amp; (</span><span class=SpellE><span
style='color:black'>stepper_curPos</span></span> <span style='color:red'>==</span>
<span class=SpellE><span style='color:black'>stepper_desPos</span></span><span
style='color:red'>));</span><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New";
color:red'>}</span><span style='font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal style='mso-pagination:none;background:white;mso-layout-grid-align:
none;text-autospace:none'><span style='font-size:10.0pt;font-family:"Courier New"'><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>
